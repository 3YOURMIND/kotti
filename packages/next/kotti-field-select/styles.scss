.kt-field-select {
	.el-select {
		position: relative;
		display: flex;

		.el-input {
			display: flex;

			&__inner {
				padding: 0;
				margin: 0;
				border: 0;
			}
		}

		// order matters
		&--disabled {
			> .el-input .el-input__inner {
				color: var(--text-05);
			}

			.el-select__tags .el-select__input {
				color: var(--text-05);
			}
		}
	}

	&--single {
		.el-input {
			flex: 1;
		}

		.el-input__inner {
			display: flex;
			align-self: center;
			width: 100%;
			line-height: 1.6;
			color: var(--text-01);
		}
	}

	&--multiple {
		$vertical-tag-gap: 2px;
		$horizontal-tag-gap: 4px;
		$tag-padding: 0.4em;
		$tag-border: 1px;

		.el-select {
			flex-direction: row-reverse;
			flex-wrap: wrap-reverse;

			&__tags {
				/* has the input we care about in multiple */
				display: inline-flex;
				flex: 1;
				width: unset !important;
				line-height: normal;
				white-space: normal;

				> span {
					/* remove el-tag container */
					display: none;
				}

				// only in case of multiple, we have this input
				.el-select__input {
					padding: 0;
					margin: 0;
					margin-left: calc(#{$tag-padding} + #{$tag-border});
					line-height: 1.6;
					color: var(--text-01);
					border: 0;
					appearance: none;
				}
			}

			.el-input {
				&__inner {
					// display: none would break focusing
					width: 0 !important;
					height: 0 !important;
				}

				&__prefix {
					width: 100%;
				}
			}
		}

		.kt-tags {
			display: flex;
			flex-wrap: wrap;

			// HACK: use negative margins to align multi-line grids of tags
			margin: #{-$vertical-tag-gap + 4px} #{-$horizontal-tag-gap};

			&__tag {
				display: flex;
				align-items: center;
				padding: $tag-padding;
				margin: $vertical-tag-gap $horizontal-tag-gap;

				font-size: 0.875em;

				color: var(--text-02);
				text-transform: capitalize;
				white-space: nowrap;
				background-color: var(--interactive-02);
				border: $tag-border solid var(--ui-02);
				border-radius: var(--field-border-radius);

				&-icon {
					$size: 16px;

					display: flex;
					align-items: center;
					justify-content: center;
					width: $size;
					height: $size;
					margin-left: 4px;
					cursor: pointer;

					background-color: var(--ui-02);
					border-radius: 50%;

					// clipping also affects the clickable area
					@supports (clip-path: circle(#{$size / 2} at center)) {
						border-radius: 0;
						clip-path: circle(#{$size / 2} at center);
					}

					&:hover {
						background-color: var(--interactive-02-hover);
					}
				}
			}
		}
	}
}

.el-select-dropdown {
	&__empty {
		width: 100%;
		padding: 10px 0;
		margin: 0;
		color: var(--text-05);
		text-align: center;
	}

	&.el-popper,
	&.el-popper.is-multiple {
		position: absolute;
		z-index: 1001;
		box-sizing: border-box;

		display: flex;
		padding: 0;
		margin: 5px 0;

		color: var(--text-01);
		background: var(--ui-background);
		border: 1px solid var(--ui-02);
		border-radius: var(--field-border-radius);
		/* shadow-base */
		box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.1), 0px 1px 2px rgba(0, 0, 0, 0.06);

		&[x-placement^='top'] {
			margin-bottom: 12px;

			.popper__arrow {
				bottom: -6px;
				left: 50%;
				margin-right: 3px;
				border-top-color: var(--ui-02);
				border-bottom-width: 0;

				&::after {
					bottom: 1px;
					margin-left: -6px;
					border-top-color: var(--ui-background);
					border-bottom-width: 0;
				}
			}
		}

		&[x-placement^='right'] {
			margin-left: 12px;

			.popper__arrow {
				top: 50%;
				left: -6px;
				margin-bottom: 3px;
				border-right-color: var(--ui-02);
				border-left-width: 0;

				&::after {
					bottom: -6px;
					left: 1px;
					border-right-color: var(--ui-background);
					border-left-width: 0;
				}
			}
		}

		&[x-placement^='bottom'] {
			margin-top: 12px;

			.popper__arrow {
				top: -6px;
				left: 50%;
				margin-right: 3px;
				border-top-width: 0;
				border-bottom-color: var(--ui-02);

				&::after {
					top: 1px;
					margin-left: -6px;
					border-top-width: 0;
					border-bottom-color: var(--ui-background);
				}
			}
		}

		&[x-placement^='left'] {
			margin-right: 12px;

			.popper__arrow {
				top: 50%;
				right: -6px;
				margin-bottom: 3px;
				border-right-width: 0;
				border-left-color: var(--ui-02);

				&::after {
					right: 1px;
					bottom: -6px;
					margin-left: -6px;
					border-right-width: 0;
					border-left-color: var(--ui-background);
				}
			}
		}

		.popper__arrow {
			filter: drop-shadow(0 2px 12px rgba(0, 0, 0, 0.03));
			border-width: 6px;

			&,
			&::after {
				position: absolute;
				display: block;
				width: 0;
				height: 0;
				border-color: transparent;
				border-style: solid;
			}

			&::after {
				content: ' ';
				border-width: 6px;
			}
		}

		.el-scrollbar {
			/*
			has 3 children:
				&__wrap,
				&__bar is-horizontal,
				&__bar is-vertical
		*/
			position: relative;
			width: 100%;
			overflow: hidden;

			&.is-empty {
				display: none;
			}

			&__bar {
				position: absolute;
				right: 2px;
				bottom: 2px;
				z-index: 1;
				border-radius: var(--field-border-radius);
				opacity: 0;
				transition: opacity 120ms ease-out;

				&.is-horizontal {
					left: 2px;
					height: 6px;

					> div.el-scrollbar__thumb {
						height: 100%;
					}
				}

				&.is-vertical {
					top: 2px;
					width: 6px;

					> div.el-scrollbar__thumb {
						width: 100%;
					}
				}

				.el-scrollbar__thumb {
					--rgb-ui-04: 107, 107, 107;
					position: relative;
					display: block;
					width: 0;
					height: 0;
					cursor: pointer;
					background-color: rgba(var(--rgb-ui-04), 0.3);
					border-radius: inherit;
					transition: background-color 300ms;

					&:hover {
						background-color: rgba(var(--rgb-ui-04), 0.5);
					}
				}
			}

			&:active,
			&:focus,
			&:hover {
				.el-scrollbar__bar {
					opacity: 1;
					transition: opacity 0.34s ease-out;
				}
			}

			&__wrap {
				height: 100%;
				overflow: scroll;

				scrollbar-width: none;
				&::-webkit-scrollbar {
					width: 0;
					height: 0;
				}

				&.el-select-dropdown__wrap {
					.el-scrollbar__view.el-select-dropdown__list {
						box-sizing: border-box;
						display: flex;
						flex-direction: column;
						width: 100%;
						padding: 6px 0;
						margin: 0;
						list-style: none;

						.el-select-dropdown__item {
							position: relative;
							box-sizing: border-box;
							flex: 1;
							padding: 0.8rem;
							margin: 0;
							overflow: hidden;
							color: var(--text-01);
							text-overflow: ellipsis;
							white-space: nowrap;
							cursor: pointer;

							&.is-disabled {
								color: var(--text-05);
								cursor: not-allowed;
							}

							&.selected {
								font-weight: 700;
								color: var(--interactive-03);

								&.hover,
								&:hover {
									color: var(--interactive-01-hover);
								}
							}

							&:hover,
							&.hover {
								&:not(.is-disabled) {
									background-color: var(--ui-01);
								}
							}
						}
					}
				}
			}
		}
	}
}
