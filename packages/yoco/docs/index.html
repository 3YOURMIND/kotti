<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>Yoco Icons</title>
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="stylesheet" href="./style.css" />
		<script src="https://unpkg.com/vue@2"></script>
		<style>
			body {
				max-width: 60rem;
				padding: 0 16px;
				margin: 0 auto;

				font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
				font-size: 16px;
				font-weight: 400;
				color: #555;
				text-align: center;
			}

			h1 {
				position: relative;
				width: auto;
				margin: 0;

				font-size: 4em;
				font-weight: 300;
				text-align: center;
			}

			h1:hover {
				cursor: pointer;
			}

			h2 {
				font-weight: 300;
			}

			a,
			a:visited {
				color: #2c66c4;
				text-decoration: none;
			}

			a:hover {
				text-decoration: underline;
			}

			.header {
				margin: 2rem 0;
			}

			.divider {
				font-size: 12px;
				font-weight: 700;
				color: #8a8a8a;
			}

			.yoco.icon-preview {
				font-size: 4rem;
			}

			.icon-container {
				box-sizing: border-box;
				float: left;

				width: 25%;

				padding: 8px;

				text-align: center;
			}

			.icons {
				display: flex;
				flex-wrap: wrap;
				margin: 8px -8px;
			}

			.icon {
				box-sizing: border-box;

				padding: 16px;

				background: #f8f8f8;
				border-radius: 4px;
			}

			.icon-container:hover .icon {
				padding: 14px;

				cursor: pointer;
				background: #fff;
				box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.1), 0 4px 16px rgba(0, 0, 0, 0.1);
			}

			.icon-liga {
				font-size: 0.875em;
				line-height: 2em;
				opacity: 0.84;
			}

			.icon-container .yoco {
				font-size: 32px;
			}

			.input-wrapper {
				position: relative;

				width: 50%;

				margin: 2rem auto;

				text-align: center;
				border-radius: 4px;
				box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.1), 0 4px 16px rgba(0, 0, 0, 0.1);
				transition: ease-in 0.22s width;
			}

			.input-wrapper:focus-within {
				width: 65%;

				box-shadow: 0 0 0 1px rgba(44, 100, 204, 1),
					0 4px 16px rgba(0, 0, 0, 0.1);
				transition: ease-out 0.22s width;
			}

			.input-wrapper span {
				position: absolute;
				top: 16px;
				left: 8px;

				color: #a8a8a8;
			}

			.input-wrapper button {
				position: absolute;
				top: 0;
				right: 0;

				width: 56px;
				height: 56px;

				color: #a8a8a8;

				background: transparent;
				border: 0;
				outline: none;
			}

			.input-wrapper button:hover {
				color: #8a8a8a;
				cursor: pointer;
			}

			input {
				box-sizing: border-box;
				width: 100%;
				height: 56px;

				padding: 0.8rem 40px;

				font-size: 16px;
				line-height: 2em;

				border: 0;
				border-radius: 0.4rem;
			}

			input:focus {
				outline: none;
			}

			@media (max-width: 480px) {
				.icon-container {
					width: 50%;
				}

				.input-wrapper,
				.input-wrapper:focus-within {
					width: 100%;
				}
			}
		</style>
	</head>

	<body>
		<div id="app">
			<div class="header">
				<h1 @click="feelLucky">
					yoco icon <i class="yoco icon-preview">{{ previewIcon }}</i>
				</h1>
				<h2>
					In house designed icons for
					<a href="https://3yourmind.github.io/kotti/foundations/icons"
						>kotti design system</a
					>
				</h2>
				<p v-if="!previewIcon">
					You got an empty icon,
					<a href="https://github.com/3YOURMIND/yoco/issues/new">it's a bug</a>
				</p>
			</div>
			<div class="input-wrapper">
				<span> <i class="yoco">search</i> </span>
				<input v-model="searchString" placeholder="Search icon" />
				<button @click="searchString=''" v-if="searchString">
					<i class="yoco">close</i>
				</button>
			</div>
			<div class="divider">Solid</div>
			<div class="icons">
				<div
					class="icon-container"
					v-for="icon in displayString(solidIconString)"
					@click="previewIcon=icon"
				>
					<div class="icon">
						<i class="yoco" ref="liga">{{ icon }}</i>
						<div class="icon-liga" v-text="icon"></div>
					</div>
				</div>
			</div>
			<div class="divider">Line</div>
			<div class="icons">
				<div
					class="icon-container"
					v-for="icon in displayString(iconString)"
					@click="previewIcon=icon"
				>
					<div class="icon">
						<i class="yoco" ref="liga">{{ icon }}</i>
						<div class="icon-liga" v-text="icon"></div>
					</div>
				</div>
			</div>
		</div>
	</body>
	<script>
		function loadJSON(callback) {
			const xobj = new XMLHttpRequest()
			xobj.overrideMimeType('application/json')
			xobj.open('GET', 'icons.json', true)
			xobj.onreadystatechange = function () {
				if (xobj.readyState == 4 && xobj.status == '200') {
					callback(xobj.responseText)
				}
			}
			xobj.send(null)
		}

		const app = new Vue({
			el: '#app',
			data() {
				return {
					iconString: [],
					solidIconString: [],
					previewIcon: 'idea',
					searchString: '',
				}
			},
			methods: {
				feelLucky() {
					for (let i = 0; i < 10; i++) {
						setTimeout(() => {
							this.previewIcon = this.iconString[
								Math.floor(Math.random() * this.iconString.length) - 1
							]
						}, i * 100)
					}
				},
				searchResults(strings) {
					let results = strings.filter((result) =>
						result.includes(this.searchString.toLowerCase()),
					)

					if (results.length === 1) this.previewIcon = results[0]

					return results
				},
				displayString(strings) {
					return this.searchString ? this.searchResults(strings) : strings
				},
			},
			created() {
				loadJSON(function (response) {
					console.log(JSON.parse(response))
					const json = JSON.parse(response).icons

					const iconMoonString = []
					const solidIconMoonString = []

					json.forEach(function (item) {
						let ligature = item.properties.ligatures.split(',')[0]

						if (!ligature) {
							console.warn(
								`The ligatures attribute is not defined for the ${item.properties.name} icon. Falling back to name.`,
							)
							ligature = item.properties.name
						}

						if (ligature.includes('solid')) solidIconMoonString.push(ligature)
						else iconMoonString.push(ligature)
					})

					app.iconString = iconMoonString
					app.solidIconString = solidIconMoonString
				})
			},
		})
	</script>
</html>
